var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,i=(e,s)=>{for(var a in s||(s={}))l.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))r.call(s,a)&&n(e,a,s[a]);return e},d=(e,s)=>{var a={};for(var n in e)l.call(e,n)&&s.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&t)for(var n of t(e))s.indexOf(n)<0&&r.call(e,n)&&(a[n]=e[n]);return a},c=(e,s,a)=>new Promise((t,l)=>{var r=e=>{try{i(a.next(e))}catch(s){l(s)}},n=e=>{try{i(a.throw(e))}catch(s){l(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,n);i((a=a.apply(e,s)).next())});import{q as o,r as x,j as m,s as u,t as h,u as j,X as p,v as f,O as b,D as g}from"./react-core-BgMqaZ7e.js";import{c as v}from"./critical-sections-DJGY1IJa.js";import"./vendor-CpI2Jcpd.js";import"./analytics-Cr-FmkW7.js";import"./forms-BAAm9TBY.js";const y="https://softdab.tech";function N(){return c(this,null,function*(){const e=yield fetch(`${y}/api/contact`);if(!e.ok)throw new Error("Failed to load contacts");return e.json()})}function w(){return c(this,null,function*(){const e=yield fetch(`${y}/api/expert-consultation`);if(!e.ok)throw new Error("Failed to load consultations");return e.json()})}const S=o,C=u,k=x.forwardRef((e,s)=>{var a=e,{className:t}=a,l=d(a,["className"]);return m.jsx(b,i({ref:s,className:v("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t)},l))});k.displayName=b.displayName;const O=x.forwardRef((e,t)=>{var l,r,n=e,{className:c,children:o}=n,x=d(n,["className","children"]);return m.jsxs(C,{children:[m.jsx(k,{}),m.jsxs(h,(l=i({ref:t,className:v("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",c)},x),r={children:[o,m.jsxs(j,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[m.jsx(p,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})]},s(l,a(r))))]})});O.displayName=h.displayName;const P=e=>{var s=e,{className:a}=s,t=d(s,["className"]);return m.jsx("div",i({className:v("flex flex-col space-y-1.5 text-center sm:text-left",a)},t))};P.displayName="DialogHeader";const _=x.forwardRef((e,s)=>{var a=e,{className:t}=a,l=d(a,["className"]);return m.jsx(f,i({ref:s,className:v("text-lg font-semibold leading-none tracking-tight",t)},l))});_.displayName=f.displayName;function E({id:e,open:s,onOpenChange:a}){const[t,l]=x.useState(null),[r,n]=x.useState(!1),[i,d]=x.useState(null);return x.useEffect(()=>{if(!s||!e)return;let a=!1;return n(!0),d(null),function(e){return c(this,null,function*(){const s=yield fetch(`${y}/api/contact/${e}`);if(!s.ok)throw new Error("Failed to load contact detail");return s.json()})}(e).then(e=>{a||l(e)}).catch(e=>!a&&d(e.message||"Failed to load")).finally(()=>!a&&n(!1)),()=>{a=!0}},[s,e]),m.jsx(S,{open:s,onOpenChange:a,children:m.jsxs(O,{className:"max-w-2xl",children:[m.jsx(P,{children:m.jsxs(_,{children:["Contact Detail #",e]})}),r&&m.jsx("p",{children:"Loading..."}),i&&m.jsx("p",{className:"text-red-600",children:i}),t&&m.jsxs("div",{className:"space-y-3 text-sm",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[m.jsx(D,{label:"Name",value:t.name}),m.jsx(D,{label:"Email",value:t.email}),m.jsx(D,{label:"Company",value:t.company}),m.jsx(D,{label:"Role",value:t.role}),m.jsx(D,{label:"Service",value:t.service}),m.jsx(D,{label:"Timeline",value:t.timeline}),m.jsx(D,{label:"Budget",value:t.budget}),m.jsx(D,{label:"Submitted",value:t.submitted_at}),m.jsx(D,{label:"Status",value:t.status}),m.jsx(D,{label:"IP",value:t.ip_address}),m.jsx(D,{label:"Referrer",value:t.referrer}),m.jsx(D,{label:"Page",value:t.page})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"User Agent"}),m.jsx("div",{className:"p-2 rounded bg-muted text-xs break-words",children:t.user_agent})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Message"}),m.jsx("div",{className:"p-3 rounded bg-muted whitespace-pre-wrap text-sm max-h-60 overflow-auto",children:t.message})]})]})]})})}function D({label:e,value:s}){return m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:e}),m.jsx("div",{className:"p-2 rounded bg-muted text-sm break-words",children:s||"—"})]})}function F({id:e,open:s,onOpenChange:a}){const[t,l]=x.useState(null),[r,n]=x.useState(!1),[i,d]=x.useState(null);return x.useEffect(()=>{if(!s||!e)return;let a=!1;return n(!0),d(null),function(e){return c(this,null,function*(){const s=yield fetch(`${y}/api/expert-consultation/${e}`);if(!s.ok)throw new Error("Failed to load consultation detail");return s.json()})}(e).then(e=>{a||l(e)}).catch(e=>!a&&d(e.message||"Failed to load")).finally(()=>!a&&n(!1)),()=>{a=!0}},[s,e]),m.jsx(S,{open:s,onOpenChange:a,children:m.jsxs(O,{className:"max-w-3xl",children:[m.jsx(P,{children:m.jsxs(_,{children:["Expert Consultation #",e]})}),r&&m.jsx("p",{children:"Loading..."}),i&&m.jsx("p",{className:"text-red-600",children:i}),t&&m.jsxs("div",{className:"space-y-3 text-sm",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[m.jsx(R,{label:"Type",value:t.client_type}),m.jsx(R,{label:"Priority",value:String(t.priority)}),m.jsx(R,{label:"Name",value:t.name}),m.jsx(R,{label:"Email",value:t.email}),m.jsx(R,{label:"Company",value:t.company}),m.jsx(R,{label:"Phone",value:t.phone}),m.jsx(R,{label:"Submitted",value:t.submitted_at}),m.jsx(R,{label:"Status",value:t.status}),m.jsx(R,{label:"IP",value:t.ip_address}),m.jsx(R,{label:"Referrer",value:t.referrer}),m.jsx(R,{label:"Page URL",value:t.page_url}),m.jsx(R,{label:"UTM",value:[t.utm_source,t.utm_medium,t.utm_campaign].filter(Boolean).join(" / ")})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"User Agent"}),m.jsx("div",{className:"p-2 rounded bg-muted text-xs break-words",children:t.user_agent})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Brief Message"}),m.jsx("div",{className:"p-3 rounded bg-muted whitespace-pre-wrap text-sm max-h-60 overflow-auto",children:t.brief_message})]}),t.details&&"object"==typeof t.details&&m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Details"}),m.jsx("div",{className:"p-3 rounded bg-muted max-h-72 overflow-auto",children:m.jsx("table",{className:"w-full text-sm",children:m.jsx("tbody",{children:Object.entries(t.details).filter(([,e])=>null!=e&&""!==e).map(([e,s])=>m.jsxs("tr",{children:[m.jsx("td",{className:"py-1 pr-3 align-top text-gray-600 whitespace-nowrap",children:$(e)}),m.jsx("td",{className:"py-1 break-words",children:String(s)})]},e))})})})]})]})]})})}function R({label:e,value:s}){return m.jsxs("div",{children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1",children:e}),m.jsx("div",{className:"p-2 rounded bg-muted text-sm break-words",children:s||"—"})]})}function $(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function I(){const[e,s]=x.useState([]),[a,t]=x.useState([]),[l,r]=x.useState(!0),[n,i]=x.useState(null),[d,o]=x.useState(null),[u,h]=x.useState(!1),[j,p]=x.useState(null),[f,b]=x.useState(!1);return x.useEffect(()=>{let e=!1;return function(){c(this,null,function*(){try{r(!0);const[a,l]=yield Promise.all([N(),w()]);e||(s(a),t(l))}catch(a){e||i(a.message||"Failed to load admin data")}finally{e||r(!1)}})}(),()=>{e=!0}},[]),m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin"}),l&&m.jsx("p",{children:"Loading…"}),n&&m.jsx("p",{className:"text-red-600",children:n}),!l&&!n&&m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[m.jsxs("section",{children:[m.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Contact Forms"}),m.jsx("div",{className:"hidden md:block overflow-x-auto border rounded-md",children:m.jsxs("table",{className:"w-full text-sm",children:[m.jsx("thead",{className:"bg-muted text-left",children:m.jsxs("tr",{children:[m.jsx(U,{children:"ID"}),m.jsx(U,{children:"Name"}),m.jsx(U,{children:"Email"}),m.jsx(U,{children:"Company"}),m.jsx(U,{children:"Date"}),m.jsx(U,{children:"Status"})]})}),m.jsx("tbody",{children:e.map(e=>m.jsxs("tr",{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>{o(e.id),h(!0)},children:[m.jsx(z,{children:e.id}),m.jsx(z,{children:e.name}),m.jsx(z,{children:e.email}),m.jsx(z,{children:e.company}),m.jsx(z,{children:e.date}),m.jsx(z,{children:e.status})]},e.id))})]})}),m.jsx("div",{className:"md:hidden space-y-3",children:e.map(e=>m.jsxs("div",{onClick:()=>{o(e.id),h(!0)},className:"border rounded-md p-4 bg-white hover:bg-muted/40 cursor-pointer",children:[m.jsxs("div",{className:"flex justify-between items-start mb-2",children:[m.jsx("span",{className:"font-semibold text-base",children:e.name}),m.jsxs("span",{className:"text-xs text-gray-500",children:["#",e.id]})]}),m.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.email}),m.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.company}),m.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-gray-500",children:[m.jsx("span",{children:e.date}),m.jsx("span",{className:"px-2 py-1 bg-muted rounded",children:e.status})]})]},e.id))})]}),m.jsxs("section",{children:[m.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Expert Consultations"}),m.jsx("div",{className:"hidden md:block overflow-x-auto border rounded-md",children:m.jsxs("table",{className:"w-full text-sm",children:[m.jsx("thead",{className:"bg-muted text-left",children:m.jsxs("tr",{children:[m.jsx(U,{children:"ID"}),m.jsx(U,{children:"Name"}),m.jsx(U,{children:"Email"}),m.jsx(U,{children:"Company"}),m.jsx(U,{children:"Type"}),m.jsx(U,{children:"Priority"}),m.jsx(U,{children:"Date"}),m.jsx(U,{children:"Status"})]})}),m.jsx("tbody",{children:a.map(e=>m.jsxs("tr",{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>{p(e.id),b(!0)},children:[m.jsx(z,{children:e.id}),m.jsx(z,{children:e.name}),m.jsx(z,{children:e.email}),m.jsx(z,{children:e.company}),m.jsx(z,{children:e.client_type}),m.jsx(z,{children:e.priority}),m.jsx(z,{children:e.date}),m.jsx(z,{children:e.status})]},e.id))})]})}),m.jsx("div",{className:"md:hidden space-y-3",children:a.map(e=>m.jsxs("div",{onClick:()=>{p(e.id),b(!0)},className:"border rounded-md p-4 bg-white hover:bg-muted/40 cursor-pointer",children:[m.jsxs("div",{className:"flex justify-between items-start mb-2",children:[m.jsx("span",{className:"font-semibold text-base",children:e.name}),m.jsxs("span",{className:"text-xs text-gray-500",children:["#",e.id]})]}),m.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.email}),m.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.company}),m.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-gray-500",children:[m.jsxs("span",{children:[e.client_type," | Priority: ",e.priority]}),m.jsx("span",{className:"px-2 py-1 bg-muted rounded",children:e.status})]}),m.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.date})]},e.id))})]})]}),m.jsx(E,{id:d,open:u,onOpenChange:h}),m.jsx(F,{id:j,open:f,onOpenChange:b})]})}function U({children:e}){return m.jsx("th",{className:"px-3 py-2 border-b font-medium text-gray-700",children:e})}function z({children:e}){return m.jsx("td",{className:"px-3 py-2 border-b align-top",children:e})}x.forwardRef((e,s)=>{var a=e,{className:t}=a,l=d(a,["className"]);return m.jsx(g,i({ref:s,className:v("text-sm text-muted-foreground",t)},l))}).displayName=g.displayName;export{I as default};
