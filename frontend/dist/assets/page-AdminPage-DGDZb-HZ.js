import{r as e,j as s}from"./vendor-react-BeulU70N.js";import{D as a,a as t,b as l,c as n}from"./forms-DsxBMDVD.js";import"./critical-sections-DNTCuqBJ.js";const r="https://softdab.tech/api",i=r.endsWith("/api")?r:`${r}/api`;async function d(){const e=await fetch(`${i}/contact`);if(!e.ok)throw new Error("Failed to load contacts");return e.json()}async function c(){const e=await fetch(`${i}/expert-consultation`);if(!e.ok)throw new Error("Failed to load consultations");return e.json()}function x({id:r,open:d,onOpenChange:c}){const[x,m]=e.useState(null),[h,u]=e.useState(!1),[j,p]=e.useState(null);return e.useEffect(()=>{if(!d||!r)return;let e=!1;return u(!0),p(null),async function(e){const s=await fetch(`${i}/contact/${e}`);if(!s.ok)throw new Error("Failed to load contact detail");return s.json()}(r).then(s=>{e||m(s)}).catch(s=>!e&&p(s.message||"Failed to load")).finally(()=>!e&&u(!1)),()=>{e=!0}},[d,r]),s.jsx(a,{open:d,onOpenChange:c,children:s.jsxs(t,{className:"max-w-2xl",children:[s.jsx(l,{children:s.jsxs(n,{children:["Contact Detail #",r]})}),h&&s.jsx("p",{children:"Loading..."}),j&&s.jsx("p",{className:"text-red-600",children:j}),x&&s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(o,{label:"Name",value:x.name}),s.jsx(o,{label:"Email",value:x.email}),s.jsx(o,{label:"Company",value:x.company}),s.jsx(o,{label:"Role",value:x.role}),s.jsx(o,{label:"Service",value:x.service}),s.jsx(o,{label:"Timeline",value:x.timeline}),s.jsx(o,{label:"Budget",value:x.budget}),s.jsx(o,{label:"Submitted",value:x.submitted_at}),s.jsx(o,{label:"Status",value:x.status}),s.jsx(o,{label:"IP",value:x.ip_address}),s.jsx(o,{label:"Referrer",value:x.referrer}),s.jsx(o,{label:"Page",value:x.page})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"User Agent"}),s.jsx("div",{className:"p-2 rounded bg-muted text-xs break-words",children:x.user_agent})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Message"}),s.jsx("div",{className:"p-3 rounded bg-muted whitespace-pre-wrap text-sm max-h-60 overflow-auto",children:x.message})]})]})]})})}function o({label:e,value:a}){return s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:e}),s.jsx("div",{className:"p-2 rounded bg-muted text-sm break-words",children:a||"—"})]})}function m({id:r,open:d,onOpenChange:c}){const[x,o]=e.useState(null),[m,j]=e.useState(!1),[p,b]=e.useState(null);return e.useEffect(()=>{if(!d||!r)return;let e=!1;return j(!0),b(null),async function(e){const s=await fetch(`${i}/expert-consultation/${e}`);if(!s.ok)throw new Error("Failed to load consultation detail");return s.json()}(r).then(s=>{e||o(s)}).catch(s=>!e&&b(s.message||"Failed to load")).finally(()=>!e&&j(!1)),()=>{e=!0}},[d,r]),s.jsx(a,{open:d,onOpenChange:c,children:s.jsxs(t,{className:"max-w-3xl",children:[s.jsx(l,{children:s.jsxs(n,{children:["Expert Consultation #",r]})}),m&&s.jsx("p",{children:"Loading..."}),p&&s.jsx("p",{className:"text-red-600",children:p}),x&&s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(h,{label:"Type",value:x.client_type}),s.jsx(h,{label:"Priority",value:String(x.priority)}),s.jsx(h,{label:"Name",value:x.name}),s.jsx(h,{label:"Email",value:x.email}),s.jsx(h,{label:"Company",value:x.company}),s.jsx(h,{label:"Phone",value:x.phone}),s.jsx(h,{label:"Submitted",value:x.submitted_at}),s.jsx(h,{label:"Status",value:x.status}),s.jsx(h,{label:"IP",value:x.ip_address}),s.jsx(h,{label:"Referrer",value:x.referrer}),s.jsx(h,{label:"Page URL",value:x.page_url}),s.jsx(h,{label:"UTM",value:[x.utm_source,x.utm_medium,x.utm_campaign].filter(Boolean).join(" / ")})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"User Agent"}),s.jsx("div",{className:"p-2 rounded bg-muted text-xs break-words",children:x.user_agent})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Brief Message"}),s.jsx("div",{className:"p-3 rounded bg-muted whitespace-pre-wrap text-sm max-h-60 overflow-auto",children:x.brief_message})]}),x.details&&"object"==typeof x.details&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Details"}),s.jsx("div",{className:"p-3 rounded bg-muted max-h-72 overflow-auto",children:s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{children:Object.entries(x.details).filter(([,e])=>null!=e&&""!==e).map(([e,a])=>s.jsxs("tr",{children:[s.jsx("td",{className:"py-1 pr-3 align-top text-gray-600 whitespace-nowrap",children:u(e)}),s.jsx("td",{className:"py-1 break-words",children:String(a)})]},e))})})})]})]})]})})}function h({label:e,value:a}){return s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:e}),s.jsx("div",{className:"p-2 rounded bg-muted text-sm break-words",children:a||"—"})]})}function u(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function j(){const[a,t]=e.useState([]),[l,n]=e.useState([]),[r,i]=e.useState(!0),[o,h]=e.useState(null),[u,j]=e.useState(null),[g,v]=e.useState(!1),[f,y]=e.useState(null),[N,w]=e.useState(!1);return e.useEffect(()=>{let e=!1;return async function(){try{i(!0);const[s,a]=await Promise.all([d(),c()]);e||(t(s),n(a))}catch(s){e||h(s.message||"Failed to load admin data")}finally{e||i(!1)}}(),()=>{e=!0}},[]),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin"}),r&&s.jsx("p",{children:"Loading…"}),o&&s.jsx("p",{className:"text-red-600",children:o}),!r&&!o&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("section",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Contact Forms"}),s.jsx("div",{className:"hidden md:block overflow-x-auto border rounded-md",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-muted text-left",children:s.jsxs("tr",{children:[s.jsx(p,{children:"ID"}),s.jsx(p,{children:"Name"}),s.jsx(p,{children:"Email"}),s.jsx(p,{children:"Company"}),s.jsx(p,{children:"Date"}),s.jsx(p,{children:"Status"})]})}),s.jsx("tbody",{children:a.map(e=>s.jsxs("tr",{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>{j(e.id),v(!0)},children:[s.jsx(b,{children:e.id}),s.jsx(b,{children:e.name}),s.jsx(b,{children:e.email}),s.jsx(b,{children:e.company}),s.jsx(b,{children:e.date}),s.jsx(b,{children:e.status})]},e.id))})]})}),s.jsx("div",{className:"md:hidden space-y-3",children:a.map(e=>s.jsxs("div",{onClick:()=>{j(e.id),v(!0)},className:"border rounded-md p-4 bg-white hover:bg-muted/40 cursor-pointer",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"font-semibold text-base",children:e.name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["#",e.id]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.email}),s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.company}),s.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-gray-500",children:[s.jsx("span",{children:e.date}),s.jsx("span",{className:"px-2 py-1 bg-muted rounded",children:e.status})]})]},e.id))})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Expert Consultations"}),s.jsx("div",{className:"hidden md:block overflow-x-auto border rounded-md",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-muted text-left",children:s.jsxs("tr",{children:[s.jsx(p,{children:"ID"}),s.jsx(p,{children:"Name"}),s.jsx(p,{children:"Email"}),s.jsx(p,{children:"Company"}),s.jsx(p,{children:"Type"}),s.jsx(p,{children:"Priority"}),s.jsx(p,{children:"Date"}),s.jsx(p,{children:"Status"})]})}),s.jsx("tbody",{children:l.map(e=>s.jsxs("tr",{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>{y(e.id),w(!0)},children:[s.jsx(b,{children:e.id}),s.jsx(b,{children:e.name}),s.jsx(b,{children:e.email}),s.jsx(b,{children:e.company}),s.jsx(b,{children:e.client_type}),s.jsx(b,{children:e.priority}),s.jsx(b,{children:e.date}),s.jsx(b,{children:e.status})]},e.id))})]})}),s.jsx("div",{className:"md:hidden space-y-3",children:l.map(e=>s.jsxs("div",{onClick:()=>{y(e.id),w(!0)},className:"border rounded-md p-4 bg-white hover:bg-muted/40 cursor-pointer",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"font-semibold text-base",children:e.name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["#",e.id]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.email}),s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.company}),s.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-gray-500",children:[s.jsxs("span",{children:[e.client_type," | Priority: ",e.priority]}),s.jsx("span",{className:"px-2 py-1 bg-muted rounded",children:e.status})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.date})]},e.id))})]})]}),s.jsx(x,{id:u,open:g,onOpenChange:v}),s.jsx(m,{id:f,open:N,onOpenChange:w})]})}function p({children:e}){return s.jsx("th",{className:"px-3 py-2 border-b font-medium text-gray-700",children:e})}function b({children:e}){return s.jsx("td",{className:"px-3 py-2 border-b align-top",children:e})}export{j as default};
